var BtnView, PocketDB, WebView, apikey, apikey_param, btnView, count, count_param, data, get_param, orignal_url, password, password_param, pocketDb, since, since_param, tblView, updateLists, url, user, username, username_param, webView, win, xhr;
win = Ti.UI.createWindow();
win.title = 'window';
win.backgroundColor = 'black';
WebView = require('webView').webView;
webView = new WebView();
webView.hide();
webView.zIndex = 10;
win.add(webView);
BtnView = require('btnView').btnView;
btnView = new BtnView();
btnView.zIndex = 20;
win.add(btnView);
data = [];
tblView = Ti.UI.createTableView();
tblView.data = data;
tblView.top = 50;
tblView.zIndex = 20;
PocketDB = require('PocketDB').PocketDB;
pocketDb = new PocketDB();
pocketDb.getRowCount();
pocketDb.deleteLists();
pocketDb.getRowCount();
updateLists = function() {
  var currentLists, currentdata, i, idx_i, label_title, row, _i, _len;
  currentdata = [];
  currentLists = pocketDb.getSavedLists();
  Ti.API.info("currentLists.length:" + currentLists.length);
  idx_i = 0;
  for (_i = 0, _len = currentLists.length; _i < _len; _i++) {
    i = currentLists[_i];
    Ti.API.info(("" + idx_i + ".title:") + i.title);
    Ti.API.info(("" + idx_i + ".time_updated:") + i.time_updated);
    Ti.API.info(("" + idx_i + ".time_added:") + i.time_added);
    idx_i += 1;
    row = Ti.UI.createTableViewRow();
    label_title = Ti.UI.createLabel();
    label_title.text = i.title;
    row.add(label_title);
    currentdata.push(row);
  }
  tblView.setData(currentdata);
};
xhr = Ti.Network.createHTTPClient();
user = 'fumi_hs';
orignal_url = "https://readitlaterlist.com/v2/";
get_param = "get?";
username_param = "username=";
password_param = "&password=";
apikey_param = "&apikey=";
since_param = "&since=";
count_param = "&count=";
username = "";
password = "";
apikey = "14bg3L7ap8377O4d51Ta4d3k49A6Xd2f";
since = "20120401";
count = "2";
url = orignal_url + get_param + username_param + username + password_param + password + apikey_param + apikey + since_param + since + count_param + count;
xhr.open('GET', url);
xhr.onload = function() {
  var lists;
  lists = JSON.parse(this.responseText);
  pocketDb.addLists(lists.list);
  updateLists();
};
xhr.send();
win.add(tblView);
win.open();